(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{311:function(e,t,r){"use strict";r.r(t);r(3),r(5),r(6);var n=r(0),o=r(28),c=(r(70),r(2),r(4),r(1),r(14),r(297)),l=r(299),d=r(300),f=r(298);function m(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function v(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}Object.keys(f).forEach((function(e){Object(l.c)(e,f[e])})),Object(l.d)("en",d);var h={components:{ValidationProvider:l.b,ValidationObserver:l.a},data:function(){return{objectInfo:{title:"",description:"",customerName:"",customerPhoneNumber:"",customerAddress:""},uploadedFiles:[],qrid:{},org:{},qrpackage:{},enableSpinner:!1}},methods:{showMsgBoxTwo:function(){var e=this;this.boxTwo="",this.$bvModal.msgBoxOk("Đã gởi yêu cầu thành công!",{noCloseOnBackdrop:!0,noCloseOnEsc:!0,title:"Thông báo",size:"sm",buttonSize:"sm",okVariant:"success",headerClass:"p-2 border-bottom-0",footerClass:"p-2 border-top-0",centered:!0}).then((function(t){e.$router.go(-1)})).catch((function(e){}))},getValidationState:function(e){var t=e.dirty,r=e.validated,n=e.valid;return t||r?void 0===n?null:n:null},onSubmit:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,n,o,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=v(v({},e.objectInfo),{},{type:"ACTIVITY.QR_REQUEST",supplierOrganizationId:e.org.id,qrid:e.$route.params.id,status:"CREATED",imageUrls:e.uploadedFiles}),t.prev=1,t.next=4,e.$axios.$post("/api/QRActivities",r);case 4:if(n=t.sent,console.log("viet onSubmit result",n),!n){t.next=16;break}return e.showMsgBoxTwo(),t.next=10,e.$axios.$get("/api/Organizations/"+e.org.id+"/users");case 10:if(o=t.sent,!(c=o.filter((function(e){return"BOSS"===e.roleCode||"SALE"===e.roleCode})))){t.next=16;break}return l=c.map((function(e){return e.id})),t.next=16,e.$axios.$get("/api/UserDeviceTokens/sendPushNotificationToListUserId",{params:{title:"QRcare",body:"Bạn có yêu cầu mới từ khách hàng",listuserid:l}});case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(1),console.log("send Request",t.t0);case 21:case"end":return t.stop()}}),t,null,[[1,18]])})))()},handleFilesUploads:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n,o,l,d;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if((n=e.target.files).length){r.next=3;break}return r.abrupt("return");case 3:if((o=[])[0]=n[0],!(o.length>0)){r.next=11;break}return l={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!1},r.next=9,Object(c.a)(o[0],l);case 9:d=r.sent,t.submitFiles(d);case 11:case"end":return r.stop()}}),r)})))()},submitFiles:function(e){var t=this;this.enableSpinner=!0;var r=new FormData;r.append("file",e),this.$axios.$post("https://media.vinaas.com/upload/cuscode",r,{headers:{"Content-Type":"multipart/form-data","Access-Control-Allow-Origin":"*"}}).then((function(e){t.uploadedFiles.push("https://media.vinaas.com/file/"+e.id),t.enableSpinner=!1})).catch((function(e){console.log("FAILURE!!",e)}))},removeImage:function(e){this.uploadedFiles=this.uploadedFiles.filter((function(t,i){return i!==e}))},getDeviceData:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.$route.params.id,t.next=3,e.$axios.$get("/api/QRIDs/"+r,{params:{filter:{include:["history"]}}});case 3:if(e.qrid=t.sent,!(e.qrid.packageId>0)){t.next=9;break}return t.next=7,e.$axios.$get("/api/QRPackages/"+e.qrid.packageId,{params:{filter:{include:["organization"]}}});case 7:e.qrpackage=t.sent,e.org=e.qrpackage.organization;case 9:case"end":return t.stop()}}),t)})))()}},created:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getDeviceData();case 2:e.objectInfo.customerName=e.qrid.ownerName,e.objectInfo.customerAddress=e.qrid.ownerAddress,e.objectInfo.customerPhoneNumber=e.qrid.ownerPhoneNumber,console.log("%c_private.vue line:133 ","color: white; background-color: #007acc;",e.qrid.ownerPhoneNumber);case 6:case"end":return t.stop()}}),t)})))()}},x=r(53),component=Object(x.a)(h,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"view_main bg-color-gray"},[r("div",{staticClass:"container pt-3",staticStyle:{"padding-bottom":"80px"}},[r("b-card",{staticClass:"fs-12 custom-card-lifecycle mb-3"},[r("b-card-text",[r("strong",[e._v("Cửa hàng chúng tôi,")]),e._v(" xin chào bạn!"),r("br"),e._v("\r\n                Để được hỗ trợ bạn cần nhập đầy đủ các thông tin bên dưới, chúng tôi sẽ hỗ trợ bạn trong thời gian sớm nhất.\r\n            ")])],1),e._v(" "),r("b-card",{staticClass:"fs-12 custom-card-lifecycle mb-3"},[r("validation-observer",{ref:"observer",scopedSlots:e._u([{key:"default",fn:function(t){var n=t.handleSubmit;return[r("b-form",{on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),n(e.onSubmit)}}},[r("validation-provider",{staticClass:"fs-12",attrs:{name:"hoten",rules:{required:!0,min:3}},scopedSlots:e._u([{key:"default",fn:function(t){return[r("b-form-group",{attrs:{id:"example-input-group-1","label-for":"example-input-1"}},[r("b-form-input",{staticClass:"fs-14",attrs:{id:"example-input-1",name:"example-input-1",placeholder:"Họ tên",state:e.getValidationState(t),"aria-describedby":"input-1-live-feedback"},model:{value:e.objectInfo.customerName,callback:function(t){e.$set(e.objectInfo,"customerName",t)},expression:"objectInfo.customerName"}}),e._v(" "),r("b-form-invalid-feedback",{staticClass:"fs-14",attrs:{id:"input-1-live-feedback"}},[e._v("Bạn phải nhập họ tên")])],1)]}}],null,!0)}),e._v(" "),r("validation-provider",{attrs:{name:"diachi",rules:{required:!0,min:3}},scopedSlots:e._u([{key:"default",fn:function(t){return[r("b-form-group",{attrs:{id:"example-input-group-2","label-for":"example-input-2"}},[r("b-form-textarea",{staticClass:"fs-14",attrs:{id:"example-input-2",name:"example-input-2",placeholder:"Địa chỉ",state:e.getValidationState(t),"aria-describedby":"input-2-live-feedback"},model:{value:e.objectInfo.customerAddress,callback:function(t){e.$set(e.objectInfo,"customerAddress",t)},expression:"objectInfo.customerAddress"}}),e._v(" "),r("b-form-invalid-feedback",{staticClass:"fs-14",attrs:{id:"input-2-live-feedback"}},[e._v("Bạn phải nhập địa chỉ")])],1)]}}],null,!0)}),e._v(" "),r("validation-provider",{attrs:{name:"phone",rules:{required:!0,min:10,regex:/((09|03|07|08|05)+([0-9]{8})\b)/g}},scopedSlots:e._u([{key:"default",fn:function(t){return[r("b-form-group",{attrs:{id:"example-input-group-3","label-for":"example-input-3"}},[r("b-form-input",{staticClass:"fs-14",attrs:{id:"example-input-3",name:"example-input-3",placeholder:"Số điện thoại",state:e.getValidationState(t),"aria-describedby":"input-3-live-feedback"},model:{value:e.objectInfo.customerPhoneNumber,callback:function(t){e.$set(e.objectInfo,"customerPhoneNumber",t)},expression:"objectInfo.customerPhoneNumber"}}),e._v(" "),r("b-form-invalid-feedback",{staticClass:"fs-14",attrs:{id:"input-3-live-feedback"}},[e._v("Bạn phải nhập số điện thoại")])],1)]}}],null,!0)}),e._v(" "),r("validation-provider",{attrs:{name:"tieude",rules:{required:!0,min:3}},scopedSlots:e._u([{key:"default",fn:function(t){return[r("b-form-group",{attrs:{id:"example-input-group-4","label-for":"example-input-4"}},[r("b-form-input",{staticClass:"fs-14",attrs:{id:"example-input-4",name:"example-input-4",placeholder:"Tiêu đề",state:e.getValidationState(t),"aria-describedby":"input-4-live-feedback"},model:{value:e.objectInfo.title,callback:function(t){e.$set(e.objectInfo,"title",t)},expression:"objectInfo.title"}}),e._v(" "),r("b-form-invalid-feedback",{staticClass:"fs-14",attrs:{id:"input-4-live-feedback"}},[e._v("Bạn phải nhập tiêu đề")])],1)]}}],null,!0)}),e._v(" "),r("b-form-group",{attrs:{id:"example-input-group-4","label-for":"example-input-5"}},[r("b-form-textarea",{staticClass:"fs-14",attrs:{id:"example-input-5",name:"example-input-5",placeholder:"Mô tả","aria-describedby":"input-5-live-feedback"},model:{value:e.objectInfo.description,callback:function(t){e.$set(e.objectInfo,"description",t)},expression:"objectInfo.description"}})],1),e._v(" "),e.uploadedFiles.length>0?r("b-row",{staticClass:"mb-3"},e._l(e.uploadedFiles,(function(t,n){return r("b-col",{key:n,attrs:{cols:"4"}},[r("div",{staticClass:"position-relative border",staticStyle:{"border-radius":"5px"}},[r("span",{staticClass:"material-icons text-danger position-absolute",staticStyle:{top:"0",right:"0"},on:{click:function(t){return e.removeImage(n)}}},[e._v("\r\n                                    delete_forever\r\n                                ")]),e._v(" "),r("b-img",{staticClass:"w-100",attrs:{src:t}})],1)])})),1):e._e(),e._v(" "),r("div",{staticClass:"text-center position-relative",staticStyle:{border:"1px solid #ced4da",padding:"10px","border-radius":"0.25rem"}},[e.enableSpinner?r("b-spinner",{attrs:{label:"Loading..."}}):r("div",[r("b-form-file",{ref:"files",staticClass:"mt-3 position-absolute w-100 h-100 m-0",attrs:{id:"filesToUpload",accept:"image/*;capture=camera",plain:""},on:{change:e.handleFilesUploads}}),e._v(" "),r("b-card-text",{staticClass:"fs-12 mb-1 text-muted"},[e._v("Chụp hình ảnh bằng Camera")]),e._v(" "),r("span",{staticClass:"material-icons text-black-50",staticStyle:{"font-size":"30px"}},[e._v(" camera_enhance")])],1)],1),e._v(" "),r("b-button",{staticClass:"mt-3 w-100",attrs:{type:"submit",variant:"primary"}},[e._v("Gởi yêu cầu")])],1)]}}])})],1)],1)])}),[],!1,null,null,null);t.default=component.exports}}]);